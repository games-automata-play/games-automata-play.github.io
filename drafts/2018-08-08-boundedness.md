---
layout:     post
title:      Boundedness for (min,plus)-automata 
date:       2018-08-03 10:00:00
author:     Nathana&euml;l Fijalkow
category:   Weighted automata
---

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
    Macros: {
      N: "{\\mathbb{N}}",
      M: "{\\mathcal{M}}",
      Ninfty: "{\\mathbb{N}_{\\infty}}",
      A: "{\\mathcal{A}}",
    }
  }
});
</script>

<p class="intro"><span class="dropcap">W</span>e prove that the universality problem for (min,plus)-automata is decidable.
The main point is to present a very useful tool: Simon's factorisation forest theorem.
This proof scheme has been used in many, many papers recently.</p>

We consider (min,plus)-automata, meaning that an automaton $\A$ computes a function

$$\A : A^* \to \Ninfty$$

where $\Ninfty = \N \cup \\{\infty\\}$.

The boundedness problem asks whether the function $\A$ is bounded, meaning

$$\exists N \in \N,\ \forall w \in A^*,\ \A(w) \le N$$

In this note, we will construct an algebraic structure from an automaton generalising the transition monoid for non-deterministic automata.
This algebraic structure is a stabilisation monoid. 
The answer to the boundedness problem can be found by inspecting the stabilisation monoid:
the function $\A$ is bounded if and only if the stabilisation monoid induced by $\A$ does not contain an unbounded witness.
The correctness proof of this characterisation relies on a generic tool for stabilisation monoids called Simon's factorisation forest theorem.

### Extending the transition monoid

Let $\A$ be a (min,plus)-automaton. The transition for letter $a$ is given by 

$$\Delta(a) \in \Ninfty^{Q \times Q}$$

which reads "the cost of going from $p$ to $q$ reading $a$ is $\Delta(a)(p,q)$".
Algebraically, we consider the semiring $(\Ninfty,\min,+)$, inducing similar operations on matrices.
The function $\A : A^* \to \Ninfty$ is defined by $\A(w) = I \cdot \Delta(w) \cdot F$ where $I,F \in \Ninfty^Q$ are the initial and final vectors
and $\Delta$ is extended to a morphism $A^* \to \Ninfty^{Q \times Q}$.

#### The special case of non-deterministic automata
Let us consider a special case: $\Delta(a) \in \\{0,\infty\\}^{Q \times Q}$ and $I,F \in \\{0,\infty\\}^Q$. 
Then $\A(w) \in \\{0,\infty\\}$, and $\A$ is essentially a non-deterministic automaton,
where $\Delta(a)(p,q) = 0$ means that there exists a transition from $p$ to $q$, and $\A(w) = 0$ if $w$ is accepted.
Indeed in algebraic terms the semiring $(\\{0,\infty\\}, \min, +)$ is isomorphic to the usual boolean semiring $(\\{0,1\\},\vee,\wedge)$ (where $0$ is mapped to $1$ and $\infty$ to $0$).
In this special case, the boundedness problem reduces to the universality problem (note that this implies PSPACE-hardness of the boundedness problem).

The transition monoid $\M_\A$ of a non-deterministic automaton $\A$ is the monoid generated by the matrices $\Delta(a)$ for $a \in A$.
In other words, we start from $\\{\Delta(a) : a \in A\\}$ and close under matrix product.
For the sake of explanation let us see $\Delta(a)$ as matrices in the boolean semiring $(\\{0,\infty\\}, \min, +)$.
Since $\\{0,\infty\\}^{Q \times Q}$ is finite, the transition monoid $\M_\A$ is finite and can be effectively computed using a simple saturation algorithm.

One can verify that $\A$ is universal if and only if $\M_\A$ does not contain a matrix $M$ such that $I \cdot M \cdot F = \infty$.
Indeed, matrices in $\M_\A$ correspond to words, and a word $w$ is rejected if $I \cdot \Delta(w) \cdot F = \infty$.


#### Projecting on a finite semiring
A crucial property for non-deterministic automata is that $\\{0,\infty\\}^{Q \times Q}$ is finite, implying that the transition monoid is finite, therefore computable.
This does not hold anymore for $\Ninfty^{Q \times Q}$.

The good news is that for answering the boundedness problem it is enough to project $\Ninfty$ into a finite semiring.
The semiring we are looking at contains three elements: $0,1$ and $\infty$. 
The intuitive meaning is in terms of costs: $0$ is free, $1$ is a small cost, and $\infty$ a large cost.
We let $\pi$ denote the projection from $\Ninfty$ to $\\{0,1,\infty\\}$, which simply sends any value $>1$ to $\infty$.

The two operations are $\min$ and $+$, with the expected semantics.
$$\begin{array}{c||c|c|c}
\quad \min \quad & \quad 0 \quad & \quad 1 \quad & \quad \infty \quad\\
\hline
0 & 0 & 0 & 0 \\
1 & 0 & 1 & 1 \\
\infty & 0 & 1 & \infty \\
\end{array}
\hspace{1cm}
\begin{array}{c||c|c|c}
\quad + \quad & \quad 0 \quad & \quad 1 \quad & \quad \infty \quad\\
\hline
0 & 0 & 1 & \infty \\
1 & 1 & \infty & \infty \\
\infty & \infty & \infty & \infty \\
\end{array}$$

Using these two operations we can multiply matrices in $\\{0,1,\infty\\}^{Q \times Q}$.

#### Stabilisation
We bring a new operator called stabilisation. 
Consider the following weighted automaton (can it be simpler?).
<figure> <img src="{{ '/images/weighted_automaton.png' | prepend: site.baseurl }}" alt="">  </figure>
We have $\A(a) = 1$. The function $\A$ is unbounded, because $\A(a^n) = n$, diverges for $n \to \infty$.
Hence we need an operator to capture the behaviour of a repeated sequence; the stabilisation operator will do just that!

Define 

$$0^\sharp = 0 \quad 1^\sharp = \infty \quad \infty^\sharp = \infty$$

At an intuitive level: $\sharp$ corresponds to iterating. Repeating a large number of times an operation with cost $0$ yields an operation with cost $0$.
However, if each operation costs $1$, the whole operation becomes very costly.

A matrix $M$ is idempotent if $M^2 = M$.
The stabilisation operator over matrices is defined for idempotent matrices by

$$ M^\sharp(s,t) = \min \left\{ M(s,p) + M(p,p)^\sharp + M(p,t) : p \in Q \right\} $$

Intuitively: how much does it cost to go from $s$ to $t$ by repeating the action $M$ a large number of times?
The path achieving the minimum goes from $s$ to some $p$, follows a loop around $p$, and then from $p$ to $t$,
with the whole operation of cost $M(s,p) + M(p,p)^\sharp + M(p,t)$.

We now have a unary operation on (idempotent) matrices.
What we have done is defining a stabilisation monoid, which is given by a set (here matrices over $\\{0,1,\infty\\}$),
a binary operation (multiplication of matrices) and a unary operation called stabilisation.

#### The stabilisation monoid of a (min,plus)-automaton

Given a (min,plus)-automaton $\A$, we define its stabilisation monoid $\M_\A$ to be the stabilisation monoid generated by the matrices $\pi(\Delta(a))$ for $a \in A$.
In other words, we start from $\\{\pi(\Delta(a)) : a \in A\\}$ and close under matrix product and stabilisation.
Since the underlying semiring is finite, the stabilisation monoid is finite and can be effectively computed using a simple saturation algorithm.

We say that a matrix $M$ is an unbounded witness if $I \cdot M \cdot F = \infty$.

> **Theorem:**
Let $\A$ be a (min,plus)-automaton.
$\A$ is bounded if and only if $\M_\A$ does not contain any unbounded witness

### Simon's factorisation forest theorem

### Finishing the proof

